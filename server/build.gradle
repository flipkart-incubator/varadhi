import org.gradle.nativeplatform.platform.internal.DefaultNativePlatform

plugins {
    id 'com.flipkart.varadhi.java-application-conventions'
}

dependencies {

    implementation(project(':common'))

    implementation('org.apache.logging.log4j:log4j-slf4j2-impl')
    implementation('org.apache.logging.log4j:log4j-core')

    implementation('com.fasterxml.jackson.core:jackson-databind')

    implementation("io.vertx:vertx-core")
    implementation("io.vertx:vertx-config")
    implementation("io.vertx:vertx-config-yaml")
    implementation("io.vertx:vertx-web")
    implementation("io.vertx:vertx-auth-common")
    implementation("io.vertx:vertx-auth-jwt")
    implementation("io.vertx:vertx-opentelemetry")
    implementation("io.vertx:vertx-micrometer-metrics")

    // TODO: check why still getting warning on class not found.
    if (DefaultNativePlatform.getCurrentOperatingSystem().isMacOsX()) {
        runtimeOnly('io.netty:netty-resolver-dns-native-macos')
    }

    implementation("io.opentelemetry:opentelemetry-sdk")
    implementation("io.opentelemetry:opentelemetry-exporter-logging")
    implementation("io.opentelemetry:opentelemetry-exporter-otlp")
    implementation("io.opentelemetry:opentelemetry-semconv")

    implementation("io.micrometer:micrometer-registry-otlp")
    implementation("io.micrometer:micrometer-registry-jmx")

    testImplementation("io.vertx:vertx-junit5")
}

application {
    mainClass = 'com.flipkart.varadhi.Server'
}
